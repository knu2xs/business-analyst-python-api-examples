{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Demonstration Template\n",
    "\n",
    "## Boilerplate Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "from pathlib import Path\n",
    "\n",
    "from arcgis.features import GeoAccessor\n",
    "from arcgis.gis import GIS\n",
    "from dotenv import load_dotenv, find_dotenv\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 650 entries, 0 to 649\n",
      "Data columns (total 2 columns):\n",
      " #   Column  Non-Null Count  Dtype   \n",
      "---  ------  --------------  -----   \n",
      " 0   LOCNUM  650 non-null    object  \n",
      " 1   SHAPE   650 non-null    geometry\n",
      "dtypes: geometry(1), object(1)\n",
      "memory usage: 10.3+ KB\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>LOCNUM</th>\n",
       "      <th>SHAPE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>105550909</td>\n",
       "      <td>{\"rings\": [[[-13659712.491841972, 5689050.6789...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>105633002</td>\n",
       "      <td>{\"rings\": [[[-13683812.381583042, 5712092.0429...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>105759815</td>\n",
       "      <td>{\"rings\": [[[-13655812.509662066, 5706201.2159...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>177692910</td>\n",
       "      <td>{\"rings\": [[[-13651962.527299367, 5690511.2941...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>180308389</td>\n",
       "      <td>{\"rings\": [[[-13640787.578395057, 5708949.7851...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      LOCNUM                                              SHAPE\n",
       "0  105550909  {\"rings\": [[[-13659712.491841972, 5689050.6789...\n",
       "1  105633002  {\"rings\": [[[-13683812.381583042, 5712092.0429...\n",
       "2  105759815  {\"rings\": [[[-13655812.509662066, 5706201.2159...\n",
       "3  177692910  {\"rings\": [[[-13651962.527299367, 5690511.2941...\n",
       "4  180308389  {\"rings\": [[[-13640787.578395057, 5708949.7851..."
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bg_pth = r'D:\\scratch\\geoenrichment-demos\\data\\interim\\interim.gdb\\pdx_coffee_study_area_3min'\n",
    "bg_df = GeoAccessor.from_featureclass(bg_pth).loc[:,['LOCNUM', 'SHAPE']]\n",
    "bg_df.spatial.set_geometry('SHAPE')\n",
    "\n",
    "bg_df.info()\n",
    "bg_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "load_dotenv(find_dotenv())\n",
    "\n",
    "gis_local = GIS('pro')\n",
    "\n",
    "gis_agol = GIS(\n",
    "    url=os.getenv('ESRI_GIS_URL'), \n",
    "    username=os.getenv('ESRI_GIS_USERNAME'),\n",
    "    password=os.getenv('ESRI_GIS_PASSWORD')\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Demonstration"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from arcgis.geoenrichment import Country, get_countries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "gis = gis_local"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iso2</th>\n",
       "      <th>iso3</th>\n",
       "      <th>country_name</th>\n",
       "      <th>vintage</th>\n",
       "      <th>country_id</th>\n",
       "      <th>data_source_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA</td>\n",
       "      <td>CAN</td>\n",
       "      <td>Canada</td>\n",
       "      <td>2021</td>\n",
       "      <td>CAN_ESRI_2021</td>\n",
       "      <td>LOCAL;;CAN_ESRI_2021</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>JP</td>\n",
       "      <td>JPN</td>\n",
       "      <td>Japan</td>\n",
       "      <td>2020</td>\n",
       "      <td>JAPAN2020</td>\n",
       "      <td>LOCAL;;JAPAN2020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>US</td>\n",
       "      <td>USA</td>\n",
       "      <td>United States</td>\n",
       "      <td>2019</td>\n",
       "      <td>USA_ESRI_2019</td>\n",
       "      <td>LOCAL;;USA_ESRI_2019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US</td>\n",
       "      <td>USA</td>\n",
       "      <td>United States</td>\n",
       "      <td>2020</td>\n",
       "      <td>USA_PL_2020</td>\n",
       "      <td>LOCAL;;USA_PL_2020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US</td>\n",
       "      <td>USA</td>\n",
       "      <td>United States</td>\n",
       "      <td>2021</td>\n",
       "      <td>USA_ESRI_2021</td>\n",
       "      <td>LOCAL;;USA_ESRI_2021</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  iso2 iso3   country_name  vintage     country_id        data_source_id\n",
       "0   CA  CAN         Canada     2021  CAN_ESRI_2021  LOCAL;;CAN_ESRI_2021\n",
       "1   JP  JPN          Japan     2020      JAPAN2020      LOCAL;;JAPAN2020\n",
       "2   US  USA  United States     2019  USA_ESRI_2019  LOCAL;;USA_ESRI_2019\n",
       "4   US  USA  United States     2020    USA_PL_2020    LOCAL;;USA_PL_2020\n",
       "3   US  USA  United States     2021  USA_ESRI_2021  LOCAL;;USA_ESRI_2021"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_countries(gis)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Country - United States 2021 ('local')>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "usa = Country('usa', gis=gis)\n",
    "\n",
    "usa"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>alias</th>\n",
       "      <th>data_collection</th>\n",
       "      <th>enrich_name</th>\n",
       "      <th>enrich_field_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CHILD_CY</td>\n",
       "      <td>2021 Child Population</td>\n",
       "      <td>AgeDependency</td>\n",
       "      <td>AgeDependency.CHILD_CY</td>\n",
       "      <td>AgeDependency_CHILD_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>WORKAGE_CY</td>\n",
       "      <td>2021 Working-Age Population</td>\n",
       "      <td>AgeDependency</td>\n",
       "      <td>AgeDependency.WORKAGE_CY</td>\n",
       "      <td>AgeDependency_WORKAGE_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>SENIOR_CY</td>\n",
       "      <td>2021 Senior Population</td>\n",
       "      <td>AgeDependency</td>\n",
       "      <td>AgeDependency.SENIOR_CY</td>\n",
       "      <td>AgeDependency_SENIOR_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CHLDDEP_CY</td>\n",
       "      <td>2021 Child Dependency Ratio</td>\n",
       "      <td>AgeDependency</td>\n",
       "      <td>AgeDependency.CHLDDEP_CY</td>\n",
       "      <td>AgeDependency_CHLDDEP_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AGEDEP_CY</td>\n",
       "      <td>2021 Age Dependency Ratio</td>\n",
       "      <td>AgeDependency</td>\n",
       "      <td>AgeDependency.AGEDEP_CY</td>\n",
       "      <td>AgeDependency_AGEDEP_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17958</th>\n",
       "      <td>MOEMEDYRMV</td>\n",
       "      <td>2019 Median Year Householder Moved In MOE (ACS...</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.MOEMEDYRMV</td>\n",
       "      <td>yearmovedin_MOEMEDYRMV</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17959</th>\n",
       "      <td>RELMEDYRMV</td>\n",
       "      <td>2019 Median Year Householder Moved In REL (ACS...</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.RELMEDYRMV</td>\n",
       "      <td>yearmovedin_RELMEDYRMV</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17960</th>\n",
       "      <td>ACSOWNER</td>\n",
       "      <td>2019 Owner Households (ACS 5-Yr)</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.ACSOWNER</td>\n",
       "      <td>yearmovedin_ACSOWNER</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17961</th>\n",
       "      <td>MOEOWNER</td>\n",
       "      <td>2019 Owner Households MOE (ACS 5-Yr)</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.MOEOWNER</td>\n",
       "      <td>yearmovedin_MOEOWNER</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17962</th>\n",
       "      <td>RELOWNER</td>\n",
       "      <td>2019 Owner Households REL (ACS 5-Yr)</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.RELOWNER</td>\n",
       "      <td>yearmovedin_RELOWNER</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>17963 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             name                                              alias  \\\n",
       "0        CHILD_CY                              2021 Child Population   \n",
       "1      WORKAGE_CY                        2021 Working-Age Population   \n",
       "2       SENIOR_CY                             2021 Senior Population   \n",
       "3      CHLDDEP_CY                        2021 Child Dependency Ratio   \n",
       "4       AGEDEP_CY                          2021 Age Dependency Ratio   \n",
       "...           ...                                                ...   \n",
       "17958  MOEMEDYRMV  2019 Median Year Householder Moved In MOE (ACS...   \n",
       "17959  RELMEDYRMV  2019 Median Year Householder Moved In REL (ACS...   \n",
       "17960    ACSOWNER                   2019 Owner Households (ACS 5-Yr)   \n",
       "17961    MOEOWNER               2019 Owner Households MOE (ACS 5-Yr)   \n",
       "17962    RELOWNER               2019 Owner Households REL (ACS 5-Yr)   \n",
       "\n",
       "      data_collection               enrich_name         enrich_field_name  \n",
       "0       AgeDependency    AgeDependency.CHILD_CY    AgeDependency_CHILD_CY  \n",
       "1       AgeDependency  AgeDependency.WORKAGE_CY  AgeDependency_WORKAGE_CY  \n",
       "2       AgeDependency   AgeDependency.SENIOR_CY   AgeDependency_SENIOR_CY  \n",
       "3       AgeDependency  AgeDependency.CHLDDEP_CY  AgeDependency_CHLDDEP_CY  \n",
       "4       AgeDependency   AgeDependency.AGEDEP_CY   AgeDependency_AGEDEP_CY  \n",
       "...               ...                       ...                       ...  \n",
       "17958     yearmovedin    yearmovedin.MOEMEDYRMV    yearmovedin_MOEMEDYRMV  \n",
       "17959     yearmovedin    yearmovedin.RELMEDYRMV    yearmovedin_RELMEDYRMV  \n",
       "17960     yearmovedin      yearmovedin.ACSOWNER      yearmovedin_ACSOWNER  \n",
       "17961     yearmovedin      yearmovedin.MOEOWNER      yearmovedin_MOEOWNER  \n",
       "17962     yearmovedin      yearmovedin.RELOWNER      yearmovedin_RELOWNER  \n",
       "\n",
       "[17963 rows x 5 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ev = usa.enrich_variables\n",
    "\n",
    "ev"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>alias</th>\n",
       "      <th>data_collection</th>\n",
       "      <th>enrich_name</th>\n",
       "      <th>enrich_field_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>TOTPOP_CY</td>\n",
       "      <td>2021 Total Population</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.TOTPOP_CY</td>\n",
       "      <td>KeyUSFacts_TOTPOP_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>GQPOP_CY</td>\n",
       "      <td>2021 Group Quarters Population</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.GQPOP_CY</td>\n",
       "      <td>KeyUSFacts_GQPOP_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>DIVINDX_CY</td>\n",
       "      <td>2021 Diversity Index</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.DIVINDX_CY</td>\n",
       "      <td>KeyUSFacts_DIVINDX_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>TOTHH_CY</td>\n",
       "      <td>2021 Total Households</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.TOTHH_CY</td>\n",
       "      <td>KeyUSFacts_TOTHH_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AVGHHSZ_CY</td>\n",
       "      <td>2021 Average Household Size</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.AVGHHSZ_CY</td>\n",
       "      <td>KeyUSFacts_AVGHHSZ_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>MEDHINC_CY</td>\n",
       "      <td>2021 Median Household Income</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.MEDHINC_CY</td>\n",
       "      <td>KeyUSFacts_MEDHINC_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>AVGHINC_CY</td>\n",
       "      <td>2021 Average Household Income</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.AVGHINC_CY</td>\n",
       "      <td>KeyUSFacts_AVGHINC_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>PCI_CY</td>\n",
       "      <td>2021 Per Capita Income</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.PCI_CY</td>\n",
       "      <td>KeyUSFacts_PCI_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>TOTHU_CY</td>\n",
       "      <td>2021 Total Housing Units</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.TOTHU_CY</td>\n",
       "      <td>KeyUSFacts_TOTHU_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>OWNER_CY</td>\n",
       "      <td>2021 Owner Occupied HUs</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.OWNER_CY</td>\n",
       "      <td>KeyUSFacts_OWNER_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>RENTER_CY</td>\n",
       "      <td>2021 Renter Occupied HUs</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.RENTER_CY</td>\n",
       "      <td>KeyUSFacts_RENTER_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>VACANT_CY</td>\n",
       "      <td>2021 Vacant Housing Units</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.VACANT_CY</td>\n",
       "      <td>KeyUSFacts_VACANT_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>MEDVAL_CY</td>\n",
       "      <td>2021 Median Home Value</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.MEDVAL_CY</td>\n",
       "      <td>KeyUSFacts_MEDVAL_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>AVGVAL_CY</td>\n",
       "      <td>2021 Average Home Value</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.AVGVAL_CY</td>\n",
       "      <td>KeyUSFacts_AVGVAL_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>DPOP_CY</td>\n",
       "      <td>2021 Total Daytime Population</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.DPOP_CY</td>\n",
       "      <td>KeyUSFacts_DPOP_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>DPOPWRK_CY</td>\n",
       "      <td>2021 Daytime Pop: Workers</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.DPOPWRK_CY</td>\n",
       "      <td>KeyUSFacts_DPOPWRK_CY</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>DPOPRES_CY</td>\n",
       "      <td>2021 Daytime Pop: Residents</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.DPOPRES_CY</td>\n",
       "      <td>KeyUSFacts_DPOPRES_CY</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          name                           alias data_collection  \\\n",
       "0    TOTPOP_CY           2021 Total Population      KeyUSFacts   \n",
       "1     GQPOP_CY  2021 Group Quarters Population      KeyUSFacts   \n",
       "2   DIVINDX_CY            2021 Diversity Index      KeyUSFacts   \n",
       "3     TOTHH_CY           2021 Total Households      KeyUSFacts   \n",
       "4   AVGHHSZ_CY     2021 Average Household Size      KeyUSFacts   \n",
       "5   MEDHINC_CY    2021 Median Household Income      KeyUSFacts   \n",
       "6   AVGHINC_CY   2021 Average Household Income      KeyUSFacts   \n",
       "7       PCI_CY          2021 Per Capita Income      KeyUSFacts   \n",
       "8     TOTHU_CY        2021 Total Housing Units      KeyUSFacts   \n",
       "9     OWNER_CY         2021 Owner Occupied HUs      KeyUSFacts   \n",
       "10   RENTER_CY        2021 Renter Occupied HUs      KeyUSFacts   \n",
       "11   VACANT_CY       2021 Vacant Housing Units      KeyUSFacts   \n",
       "12   MEDVAL_CY          2021 Median Home Value      KeyUSFacts   \n",
       "13   AVGVAL_CY         2021 Average Home Value      KeyUSFacts   \n",
       "14     DPOP_CY   2021 Total Daytime Population      KeyUSFacts   \n",
       "15  DPOPWRK_CY       2021 Daytime Pop: Workers      KeyUSFacts   \n",
       "16  DPOPRES_CY     2021 Daytime Pop: Residents      KeyUSFacts   \n",
       "\n",
       "              enrich_name      enrich_field_name  \n",
       "0    KeyUSFacts.TOTPOP_CY   KeyUSFacts_TOTPOP_CY  \n",
       "1     KeyUSFacts.GQPOP_CY    KeyUSFacts_GQPOP_CY  \n",
       "2   KeyUSFacts.DIVINDX_CY  KeyUSFacts_DIVINDX_CY  \n",
       "3     KeyUSFacts.TOTHH_CY    KeyUSFacts_TOTHH_CY  \n",
       "4   KeyUSFacts.AVGHHSZ_CY  KeyUSFacts_AVGHHSZ_CY  \n",
       "5   KeyUSFacts.MEDHINC_CY  KeyUSFacts_MEDHINC_CY  \n",
       "6   KeyUSFacts.AVGHINC_CY  KeyUSFacts_AVGHINC_CY  \n",
       "7       KeyUSFacts.PCI_CY      KeyUSFacts_PCI_CY  \n",
       "8     KeyUSFacts.TOTHU_CY    KeyUSFacts_TOTHU_CY  \n",
       "9     KeyUSFacts.OWNER_CY    KeyUSFacts_OWNER_CY  \n",
       "10   KeyUSFacts.RENTER_CY   KeyUSFacts_RENTER_CY  \n",
       "11   KeyUSFacts.VACANT_CY   KeyUSFacts_VACANT_CY  \n",
       "12   KeyUSFacts.MEDVAL_CY   KeyUSFacts_MEDVAL_CY  \n",
       "13   KeyUSFacts.AVGVAL_CY   KeyUSFacts_AVGVAL_CY  \n",
       "14     KeyUSFacts.DPOP_CY     KeyUSFacts_DPOP_CY  \n",
       "15  KeyUSFacts.DPOPWRK_CY  KeyUSFacts_DPOPWRK_CY  \n",
       "16  KeyUSFacts.DPOPRES_CY  KeyUSFacts_DPOPRES_CY  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kv = ev[\n",
    "    (ev.name.str.endswith('_CY'))\n",
    "    & (ev.data_collection.str.lower().str.startswith('key'))\n",
    "].reset_index(drop=True)\n",
    "\n",
    "kv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 650 entries, 0 to 649\n",
      "Data columns (total 21 columns):\n",
      " #   Column                 Non-Null Count  Dtype   \n",
      "---  ------                 --------------  -----   \n",
      " 0   locnum                 650 non-null    object  \n",
      " 1   has_data               650 non-null    int64   \n",
      " 2   aggregation_method     650 non-null    object  \n",
      " 3   keyusfacts_totpop_cy   650 non-null    float64 \n",
      " 4   keyusfacts_gqpop_cy    650 non-null    float64 \n",
      " 5   keyusfacts_divindx_cy  650 non-null    float64 \n",
      " 6   keyusfacts_tothh_cy    650 non-null    float64 \n",
      " 7   keyusfacts_avghhsz_cy  650 non-null    float64 \n",
      " 8   keyusfacts_medhinc_cy  650 non-null    float64 \n",
      " 9   keyusfacts_avghinc_cy  650 non-null    float64 \n",
      " 10  keyusfacts_pci_cy      650 non-null    float64 \n",
      " 11  keyusfacts_tothu_cy    650 non-null    float64 \n",
      " 12  keyusfacts_owner_cy    650 non-null    float64 \n",
      " 13  keyusfacts_renter_cy   650 non-null    float64 \n",
      " 14  keyusfacts_vacant_cy   650 non-null    float64 \n",
      " 15  keyusfacts_medval_cy   650 non-null    float64 \n",
      " 16  keyusfacts_avgval_cy   650 non-null    float64 \n",
      " 17  keyusfacts_dpop_cy     650 non-null    float64 \n",
      " 18  keyusfacts_dpopwrk_cy  650 non-null    float64 \n",
      " 19  keyusfacts_dpopres_cy  650 non-null    float64 \n",
      " 20  SHAPE                  650 non-null    geometry\n",
      "dtypes: float64(17), geometry(1), int64(1), object(2)\n",
      "memory usage: 106.8+ KB\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>locnum</th>\n",
       "      <th>has_data</th>\n",
       "      <th>aggregation_method</th>\n",
       "      <th>keyusfacts_totpop_cy</th>\n",
       "      <th>keyusfacts_gqpop_cy</th>\n",
       "      <th>keyusfacts_divindx_cy</th>\n",
       "      <th>keyusfacts_tothh_cy</th>\n",
       "      <th>keyusfacts_avghhsz_cy</th>\n",
       "      <th>keyusfacts_medhinc_cy</th>\n",
       "      <th>keyusfacts_avghinc_cy</th>\n",
       "      <th>...</th>\n",
       "      <th>keyusfacts_tothu_cy</th>\n",
       "      <th>keyusfacts_owner_cy</th>\n",
       "      <th>keyusfacts_renter_cy</th>\n",
       "      <th>keyusfacts_vacant_cy</th>\n",
       "      <th>keyusfacts_medval_cy</th>\n",
       "      <th>keyusfacts_avgval_cy</th>\n",
       "      <th>keyusfacts_dpop_cy</th>\n",
       "      <th>keyusfacts_dpopwrk_cy</th>\n",
       "      <th>keyusfacts_dpopres_cy</th>\n",
       "      <th>SHAPE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>105550909</td>\n",
       "      <td>1</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>5443.0</td>\n",
       "      <td>47.0</td>\n",
       "      <td>36.4</td>\n",
       "      <td>2391.0</td>\n",
       "      <td>2.26</td>\n",
       "      <td>104273.0</td>\n",
       "      <td>155998.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2546.0</td>\n",
       "      <td>1690.0</td>\n",
       "      <td>701.0</td>\n",
       "      <td>155.0</td>\n",
       "      <td>637854.0</td>\n",
       "      <td>723476.0</td>\n",
       "      <td>8430.0</td>\n",
       "      <td>6007.0</td>\n",
       "      <td>2423.0</td>\n",
       "      <td>{\"rings\": [[[-122.70728508062291, 45.427343047...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>105633002</td>\n",
       "      <td>1</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>47.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>61.2</td>\n",
       "      <td>19.0</td>\n",
       "      <td>2.47</td>\n",
       "      <td>89162.0</td>\n",
       "      <td>110817.0</td>\n",
       "      <td>...</td>\n",
       "      <td>20.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>460000.0</td>\n",
       "      <td>482500.0</td>\n",
       "      <td>1197.0</td>\n",
       "      <td>1177.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>{\"rings\": [[[-122.92377807415231, 45.572420302...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>105759815</td>\n",
       "      <td>1</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>11170.0</td>\n",
       "      <td>1736.0</td>\n",
       "      <td>46.7</td>\n",
       "      <td>6869.0</td>\n",
       "      <td>1.37</td>\n",
       "      <td>49113.0</td>\n",
       "      <td>89320.0</td>\n",
       "      <td>...</td>\n",
       "      <td>7973.0</td>\n",
       "      <td>1456.0</td>\n",
       "      <td>5413.0</td>\n",
       "      <td>1104.0</td>\n",
       "      <td>626476.0</td>\n",
       "      <td>698586.0</td>\n",
       "      <td>29779.0</td>\n",
       "      <td>24597.0</td>\n",
       "      <td>5182.0</td>\n",
       "      <td>{\"rings\": [[[-122.6722509453407, 45.5353649659...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>177692910</td>\n",
       "      <td>1</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>6255.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>47.0</td>\n",
       "      <td>2636.0</td>\n",
       "      <td>2.35</td>\n",
       "      <td>51995.0</td>\n",
       "      <td>67261.0</td>\n",
       "      <td>...</td>\n",
       "      <td>2826.0</td>\n",
       "      <td>1466.0</td>\n",
       "      <td>1169.0</td>\n",
       "      <td>190.0</td>\n",
       "      <td>376166.0</td>\n",
       "      <td>399727.0</td>\n",
       "      <td>5677.0</td>\n",
       "      <td>2756.0</td>\n",
       "      <td>2921.0</td>\n",
       "      <td>{\"rings\": [[[-122.6376659650056, 45.4365507371...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>180308389</td>\n",
       "      <td>1</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>13200.0</td>\n",
       "      <td>432.0</td>\n",
       "      <td>64.9</td>\n",
       "      <td>5109.0</td>\n",
       "      <td>2.50</td>\n",
       "      <td>56206.0</td>\n",
       "      <td>69408.0</td>\n",
       "      <td>...</td>\n",
       "      <td>5369.0</td>\n",
       "      <td>2949.0</td>\n",
       "      <td>2160.0</td>\n",
       "      <td>260.0</td>\n",
       "      <td>371665.0</td>\n",
       "      <td>390047.0</td>\n",
       "      <td>12250.0</td>\n",
       "      <td>5193.0</td>\n",
       "      <td>7057.0</td>\n",
       "      <td>{\"rings\": [[[-122.53727969104438, 45.552657456...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      locnum  has_data                                 aggregation_method  \\\n",
       "0  105550909         1  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "1  105633002         1  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "2  105759815         1  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "3  177692910         1  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "4  180308389         1  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "\n",
       "   keyusfacts_totpop_cy  keyusfacts_gqpop_cy  keyusfacts_divindx_cy  \\\n",
       "0                5443.0                 47.0                   36.4   \n",
       "1                  47.0                  0.0                   61.2   \n",
       "2               11170.0               1736.0                   46.7   \n",
       "3                6255.0                 66.0                   47.0   \n",
       "4               13200.0                432.0                   64.9   \n",
       "\n",
       "   keyusfacts_tothh_cy  keyusfacts_avghhsz_cy  keyusfacts_medhinc_cy  \\\n",
       "0               2391.0                   2.26               104273.0   \n",
       "1                 19.0                   2.47                89162.0   \n",
       "2               6869.0                   1.37                49113.0   \n",
       "3               2636.0                   2.35                51995.0   \n",
       "4               5109.0                   2.50                56206.0   \n",
       "\n",
       "   keyusfacts_avghinc_cy  ...  keyusfacts_tothu_cy  keyusfacts_owner_cy  \\\n",
       "0               155998.0  ...               2546.0               1690.0   \n",
       "1               110817.0  ...                 20.0                 10.0   \n",
       "2                89320.0  ...               7973.0               1456.0   \n",
       "3                67261.0  ...               2826.0               1466.0   \n",
       "4                69408.0  ...               5369.0               2949.0   \n",
       "\n",
       "   keyusfacts_renter_cy  keyusfacts_vacant_cy  keyusfacts_medval_cy  \\\n",
       "0                 701.0                 155.0              637854.0   \n",
       "1                   9.0                   1.0              460000.0   \n",
       "2                5413.0                1104.0              626476.0   \n",
       "3                1169.0                 190.0              376166.0   \n",
       "4                2160.0                 260.0              371665.0   \n",
       "\n",
       "   keyusfacts_avgval_cy  keyusfacts_dpop_cy  keyusfacts_dpopwrk_cy  \\\n",
       "0              723476.0              8430.0                 6007.0   \n",
       "1              482500.0              1197.0                 1177.0   \n",
       "2              698586.0             29779.0                24597.0   \n",
       "3              399727.0              5677.0                 2756.0   \n",
       "4              390047.0             12250.0                 5193.0   \n",
       "\n",
       "   keyusfacts_dpopres_cy                                              SHAPE  \n",
       "0                 2423.0  {\"rings\": [[[-122.70728508062291, 45.427343047...  \n",
       "1                   20.0  {\"rings\": [[[-122.92377807415231, 45.572420302...  \n",
       "2                 5182.0  {\"rings\": [[[-122.6722509453407, 45.5353649659...  \n",
       "3                 2921.0  {\"rings\": [[[-122.6376659650056, 45.4365507371...  \n",
       "4                 7057.0  {\"rings\": [[[-122.53727969104438, 45.552657456...  \n",
       "\n",
       "[5 rows x 21 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "e_df = usa.enrich(bg_df, kv)\n",
    "\n",
    "e_df.info()\n",
    "e_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>keyusfacts_totpop_cy</th>\n",
       "      <th>keyusfacts_gqpop_cy</th>\n",
       "      <th>keyusfacts_divindx_cy</th>\n",
       "      <th>keyusfacts_tothh_cy</th>\n",
       "      <th>keyusfacts_avghhsz_cy</th>\n",
       "      <th>keyusfacts_medhinc_cy</th>\n",
       "      <th>keyusfacts_avghinc_cy</th>\n",
       "      <th>keyusfacts_pci_cy</th>\n",
       "      <th>keyusfacts_tothu_cy</th>\n",
       "      <th>keyusfacts_owner_cy</th>\n",
       "      <th>keyusfacts_renter_cy</th>\n",
       "      <th>keyusfacts_vacant_cy</th>\n",
       "      <th>keyusfacts_medval_cy</th>\n",
       "      <th>keyusfacts_avgval_cy</th>\n",
       "      <th>keyusfacts_dpop_cy</th>\n",
       "      <th>keyusfacts_dpopwrk_cy</th>\n",
       "      <th>keyusfacts_dpopres_cy</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>5443.0</td>\n",
       "      <td>47.0</td>\n",
       "      <td>36.4</td>\n",
       "      <td>2391.0</td>\n",
       "      <td>2.26</td>\n",
       "      <td>104273.0</td>\n",
       "      <td>155998.0</td>\n",
       "      <td>69215.0</td>\n",
       "      <td>2546.0</td>\n",
       "      <td>1690.0</td>\n",
       "      <td>701.0</td>\n",
       "      <td>155.0</td>\n",
       "      <td>637854.0</td>\n",
       "      <td>723476.0</td>\n",
       "      <td>8430.0</td>\n",
       "      <td>6007.0</td>\n",
       "      <td>2423.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>47.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>61.2</td>\n",
       "      <td>19.0</td>\n",
       "      <td>2.47</td>\n",
       "      <td>89162.0</td>\n",
       "      <td>110817.0</td>\n",
       "      <td>42707.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>460000.0</td>\n",
       "      <td>482500.0</td>\n",
       "      <td>1197.0</td>\n",
       "      <td>1177.0</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>11170.0</td>\n",
       "      <td>1736.0</td>\n",
       "      <td>46.7</td>\n",
       "      <td>6869.0</td>\n",
       "      <td>1.37</td>\n",
       "      <td>49113.0</td>\n",
       "      <td>89320.0</td>\n",
       "      <td>55615.0</td>\n",
       "      <td>7973.0</td>\n",
       "      <td>1456.0</td>\n",
       "      <td>5413.0</td>\n",
       "      <td>1104.0</td>\n",
       "      <td>626476.0</td>\n",
       "      <td>698586.0</td>\n",
       "      <td>29779.0</td>\n",
       "      <td>24597.0</td>\n",
       "      <td>5182.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>6255.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>47.0</td>\n",
       "      <td>2636.0</td>\n",
       "      <td>2.35</td>\n",
       "      <td>51995.0</td>\n",
       "      <td>67261.0</td>\n",
       "      <td>28038.0</td>\n",
       "      <td>2826.0</td>\n",
       "      <td>1466.0</td>\n",
       "      <td>1169.0</td>\n",
       "      <td>190.0</td>\n",
       "      <td>376166.0</td>\n",
       "      <td>399727.0</td>\n",
       "      <td>5677.0</td>\n",
       "      <td>2756.0</td>\n",
       "      <td>2921.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>13200.0</td>\n",
       "      <td>432.0</td>\n",
       "      <td>64.9</td>\n",
       "      <td>5109.0</td>\n",
       "      <td>2.50</td>\n",
       "      <td>56206.0</td>\n",
       "      <td>69408.0</td>\n",
       "      <td>26777.0</td>\n",
       "      <td>5369.0</td>\n",
       "      <td>2949.0</td>\n",
       "      <td>2160.0</td>\n",
       "      <td>260.0</td>\n",
       "      <td>371665.0</td>\n",
       "      <td>390047.0</td>\n",
       "      <td>12250.0</td>\n",
       "      <td>5193.0</td>\n",
       "      <td>7057.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>645</th>\n",
       "      <td>2619.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>61.9</td>\n",
       "      <td>907.0</td>\n",
       "      <td>2.88</td>\n",
       "      <td>56985.0</td>\n",
       "      <td>64923.0</td>\n",
       "      <td>22876.0</td>\n",
       "      <td>986.0</td>\n",
       "      <td>582.0</td>\n",
       "      <td>325.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>300610.0</td>\n",
       "      <td>298451.0</td>\n",
       "      <td>3805.0</td>\n",
       "      <td>2433.0</td>\n",
       "      <td>1372.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>646</th>\n",
       "      <td>3779.0</td>\n",
       "      <td>274.0</td>\n",
       "      <td>47.8</td>\n",
       "      <td>2418.0</td>\n",
       "      <td>1.45</td>\n",
       "      <td>57930.0</td>\n",
       "      <td>76393.0</td>\n",
       "      <td>47351.0</td>\n",
       "      <td>2885.0</td>\n",
       "      <td>121.0</td>\n",
       "      <td>2297.0</td>\n",
       "      <td>467.0</td>\n",
       "      <td>522917.0</td>\n",
       "      <td>543388.0</td>\n",
       "      <td>14134.0</td>\n",
       "      <td>12724.0</td>\n",
       "      <td>1410.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>647</th>\n",
       "      <td>12439.0</td>\n",
       "      <td>119.0</td>\n",
       "      <td>70.2</td>\n",
       "      <td>4917.0</td>\n",
       "      <td>2.51</td>\n",
       "      <td>89556.0</td>\n",
       "      <td>116526.0</td>\n",
       "      <td>45907.0</td>\n",
       "      <td>5102.0</td>\n",
       "      <td>2487.0</td>\n",
       "      <td>2429.0</td>\n",
       "      <td>185.0</td>\n",
       "      <td>439261.0</td>\n",
       "      <td>497304.0</td>\n",
       "      <td>12566.0</td>\n",
       "      <td>7027.0</td>\n",
       "      <td>5539.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>648</th>\n",
       "      <td>2046.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>70.3</td>\n",
       "      <td>1021.0</td>\n",
       "      <td>2.00</td>\n",
       "      <td>53796.0</td>\n",
       "      <td>68147.0</td>\n",
       "      <td>31324.0</td>\n",
       "      <td>1073.0</td>\n",
       "      <td>182.0</td>\n",
       "      <td>840.0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>387975.0</td>\n",
       "      <td>432240.0</td>\n",
       "      <td>4280.0</td>\n",
       "      <td>3391.0</td>\n",
       "      <td>889.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>649</th>\n",
       "      <td>10659.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>4120.0</td>\n",
       "      <td>2.58</td>\n",
       "      <td>126620.0</td>\n",
       "      <td>156965.0</td>\n",
       "      <td>58936.0</td>\n",
       "      <td>4426.0</td>\n",
       "      <td>2986.0</td>\n",
       "      <td>1134.0</td>\n",
       "      <td>306.0</td>\n",
       "      <td>538664.0</td>\n",
       "      <td>560888.0</td>\n",
       "      <td>9533.0</td>\n",
       "      <td>3632.0</td>\n",
       "      <td>5901.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>650 rows × 17 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     keyusfacts_totpop_cy  keyusfacts_gqpop_cy  keyusfacts_divindx_cy  \\\n",
       "0                  5443.0                 47.0                   36.4   \n",
       "1                    47.0                  0.0                   61.2   \n",
       "2                 11170.0               1736.0                   46.7   \n",
       "3                  6255.0                 66.0                   47.0   \n",
       "4                 13200.0                432.0                   64.9   \n",
       "..                    ...                  ...                    ...   \n",
       "645                2619.0                 10.0                   61.9   \n",
       "646                3779.0                274.0                   47.8   \n",
       "647               12439.0                119.0                   70.2   \n",
       "648                2046.0                  0.0                   70.3   \n",
       "649               10659.0                  8.0                   61.0   \n",
       "\n",
       "     keyusfacts_tothh_cy  keyusfacts_avghhsz_cy  keyusfacts_medhinc_cy  \\\n",
       "0                 2391.0                   2.26               104273.0   \n",
       "1                   19.0                   2.47                89162.0   \n",
       "2                 6869.0                   1.37                49113.0   \n",
       "3                 2636.0                   2.35                51995.0   \n",
       "4                 5109.0                   2.50                56206.0   \n",
       "..                   ...                    ...                    ...   \n",
       "645                907.0                   2.88                56985.0   \n",
       "646               2418.0                   1.45                57930.0   \n",
       "647               4917.0                   2.51                89556.0   \n",
       "648               1021.0                   2.00                53796.0   \n",
       "649               4120.0                   2.58               126620.0   \n",
       "\n",
       "     keyusfacts_avghinc_cy  keyusfacts_pci_cy  keyusfacts_tothu_cy  \\\n",
       "0                 155998.0            69215.0               2546.0   \n",
       "1                 110817.0            42707.0                 20.0   \n",
       "2                  89320.0            55615.0               7973.0   \n",
       "3                  67261.0            28038.0               2826.0   \n",
       "4                  69408.0            26777.0               5369.0   \n",
       "..                     ...                ...                  ...   \n",
       "645                64923.0            22876.0                986.0   \n",
       "646                76393.0            47351.0               2885.0   \n",
       "647               116526.0            45907.0               5102.0   \n",
       "648                68147.0            31324.0               1073.0   \n",
       "649               156965.0            58936.0               4426.0   \n",
       "\n",
       "     keyusfacts_owner_cy  keyusfacts_renter_cy  keyusfacts_vacant_cy  \\\n",
       "0                 1690.0                 701.0                 155.0   \n",
       "1                   10.0                   9.0                   1.0   \n",
       "2                 1456.0                5413.0                1104.0   \n",
       "3                 1466.0                1169.0                 190.0   \n",
       "4                 2949.0                2160.0                 260.0   \n",
       "..                   ...                   ...                   ...   \n",
       "645                582.0                 325.0                  79.0   \n",
       "646                121.0                2297.0                 467.0   \n",
       "647               2487.0                2429.0                 185.0   \n",
       "648                182.0                 840.0                  52.0   \n",
       "649               2986.0                1134.0                 306.0   \n",
       "\n",
       "     keyusfacts_medval_cy  keyusfacts_avgval_cy  keyusfacts_dpop_cy  \\\n",
       "0                637854.0              723476.0              8430.0   \n",
       "1                460000.0              482500.0              1197.0   \n",
       "2                626476.0              698586.0             29779.0   \n",
       "3                376166.0              399727.0              5677.0   \n",
       "4                371665.0              390047.0             12250.0   \n",
       "..                    ...                   ...                 ...   \n",
       "645              300610.0              298451.0              3805.0   \n",
       "646              522917.0              543388.0             14134.0   \n",
       "647              439261.0              497304.0             12566.0   \n",
       "648              387975.0              432240.0              4280.0   \n",
       "649              538664.0              560888.0              9533.0   \n",
       "\n",
       "     keyusfacts_dpopwrk_cy  keyusfacts_dpopres_cy  \n",
       "0                   6007.0                 2423.0  \n",
       "1                   1177.0                   20.0  \n",
       "2                  24597.0                 5182.0  \n",
       "3                   2756.0                 2921.0  \n",
       "4                   5193.0                 7057.0  \n",
       "..                     ...                    ...  \n",
       "645                 2433.0                 1372.0  \n",
       "646                12724.0                 1410.0  \n",
       "647                 7027.0                 5539.0  \n",
       "648                 3391.0                  889.0  \n",
       "649                 3632.0                 5901.0  \n",
       "\n",
       "[650 rows x 17 columns]"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "e_df.loc[:,[c for c in e_df.columns if c in list(kv.enrich_field_name.str.lower())]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
