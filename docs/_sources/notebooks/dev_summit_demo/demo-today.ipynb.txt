{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Demonstration\n",
    "\n",
    "## Boilerplate Setup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "from pathlib import Path\n",
    "\n",
    "from arcgis.features import GeoAccessor\n",
    "from arcgis.gis import GIS\n",
    "from dotenv import load_dotenv, find_dotenv\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 650 entries, 0 to 649\n",
      "Data columns (total 2 columns):\n",
      " #   Column  Non-Null Count  Dtype   \n",
      "---  ------  --------------  -----   \n",
      " 0   LOCNUM  650 non-null    object  \n",
      " 1   SHAPE   650 non-null    geometry\n",
      "dtypes: geometry(1), object(1)\n",
      "memory usage: 10.3+ KB\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>LOCNUM</th>\n",
       "      <th>SHAPE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>105550909</td>\n",
       "      <td>{\"rings\": [[[-13659712.491841972, 5689050.6789...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>105633002</td>\n",
       "      <td>{\"rings\": [[[-13683812.381583042, 5712092.0429...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>105759815</td>\n",
       "      <td>{\"rings\": [[[-13655812.509662066, 5706201.2159...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>177692910</td>\n",
       "      <td>{\"rings\": [[[-13651962.527299367, 5690511.2941...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>180308389</td>\n",
       "      <td>{\"rings\": [[[-13640787.578395057, 5708949.7851...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      LOCNUM                                              SHAPE\n",
       "0  105550909  {\"rings\": [[[-13659712.491841972, 5689050.6789...\n",
       "1  105633002  {\"rings\": [[[-13683812.381583042, 5712092.0429...\n",
       "2  105759815  {\"rings\": [[[-13655812.509662066, 5706201.2159...\n",
       "3  177692910  {\"rings\": [[[-13651962.527299367, 5690511.2941...\n",
       "4  180308389  {\"rings\": [[[-13640787.578395057, 5708949.7851..."
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "in_pth = r'D:\\scratch\\geoenrichment-demos\\data\\interim\\interim.gdb\\pdx_coffee_study_area_3min'\n",
    "in_df = GeoAccessor.from_featureclass(in_pth).loc[:,['LOCNUM', 'SHAPE']]\n",
    "in_df.spatial.set_geometry('SHAPE')\n",
    "\n",
    "in_df.info()\n",
    "in_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "load_dotenv(find_dotenv())\n",
    "\n",
    "gis_local = GIS('pro')\n",
    "\n",
    "gis_agol = GIS(\n",
    "    url=os.getenv('ESRI_GIS_URL'), \n",
    "    username=os.getenv('ESRI_GIS_USERNAME'),\n",
    "    password=os.getenv('ESRI_GIS_PASSWORD')\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Demonstration"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "from arcgis.geoenrichment import Country, get_countries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [],
   "source": [
    "gis = gis_agol"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iso2</th>\n",
       "      <th>iso3</th>\n",
       "      <th>country_name</th>\n",
       "      <th>datasets</th>\n",
       "      <th>default_dataset</th>\n",
       "      <th>alt_name</th>\n",
       "      <th>continent</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AL</td>\n",
       "      <td>ALB</td>\n",
       "      <td>Albania</td>\n",
       "      <td>[ALB_MBR_2020]</td>\n",
       "      <td>ALB_MBR_2020</td>\n",
       "      <td>ALBANIA</td>\n",
       "      <td>Europe</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>DZ</td>\n",
       "      <td>DZA</td>\n",
       "      <td>Algeria</td>\n",
       "      <td>[DZA_MBR_2019]</td>\n",
       "      <td>DZA_MBR_2019</td>\n",
       "      <td>ALGERIA</td>\n",
       "      <td>Africa</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AD</td>\n",
       "      <td>AND</td>\n",
       "      <td>Andorra</td>\n",
       "      <td>[AND_MBR_2020]</td>\n",
       "      <td>AND_MBR_2020</td>\n",
       "      <td>ANDORRA</td>\n",
       "      <td>Europe</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AO</td>\n",
       "      <td>AGO</td>\n",
       "      <td>Angola</td>\n",
       "      <td>[AGO_MBR_2019]</td>\n",
       "      <td>AGO_MBR_2019</td>\n",
       "      <td>ANGOLA</td>\n",
       "      <td>Africa</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AI</td>\n",
       "      <td>AIA</td>\n",
       "      <td>Anguilla</td>\n",
       "      <td>[AIA_MBR_2020]</td>\n",
       "      <td>AIA_MBR_2020</td>\n",
       "      <td>ANGUILLA</td>\n",
       "      <td>North America</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>149</th>\n",
       "      <td>UZ</td>\n",
       "      <td>UZB</td>\n",
       "      <td>Uzbekistan</td>\n",
       "      <td>[UZB_MBR_2020]</td>\n",
       "      <td>UZB_MBR_2020</td>\n",
       "      <td>UZBEKISTAN</td>\n",
       "      <td>Asia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150</th>\n",
       "      <td>VE</td>\n",
       "      <td>VEN</td>\n",
       "      <td>Venezuela</td>\n",
       "      <td>[VEN_MBR_2020]</td>\n",
       "      <td>VEN_MBR_2020</td>\n",
       "      <td>VENEZUELA, BOLIVARIAN REPUBLIC OF</td>\n",
       "      <td>South America</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>151</th>\n",
       "      <td>VN</td>\n",
       "      <td>VNM</td>\n",
       "      <td>Vietnam</td>\n",
       "      <td>[VNM_MBR_2020]</td>\n",
       "      <td>VNM_MBR_2020</td>\n",
       "      <td>VIET NAM</td>\n",
       "      <td>Asia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>152</th>\n",
       "      <td>VI</td>\n",
       "      <td>VIR</td>\n",
       "      <td>Virgin Islands</td>\n",
       "      <td>[VIR_MBR_2020]</td>\n",
       "      <td>VIR_MBR_2020</td>\n",
       "      <td>UNITED STATES VIRGIN ISLANDS</td>\n",
       "      <td>North America</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>153</th>\n",
       "      <td>ZM</td>\n",
       "      <td>ZMB</td>\n",
       "      <td>Zambia</td>\n",
       "      <td>[ZMB_MBR_2019]</td>\n",
       "      <td>ZMB_MBR_2019</td>\n",
       "      <td>ZAMBIA</td>\n",
       "      <td>Africa</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>154 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    iso2 iso3    country_name        datasets default_dataset  \\\n",
       "0     AL  ALB         Albania  [ALB_MBR_2020]    ALB_MBR_2020   \n",
       "1     DZ  DZA         Algeria  [DZA_MBR_2019]    DZA_MBR_2019   \n",
       "2     AD  AND         Andorra  [AND_MBR_2020]    AND_MBR_2020   \n",
       "3     AO  AGO          Angola  [AGO_MBR_2019]    AGO_MBR_2019   \n",
       "4     AI  AIA        Anguilla  [AIA_MBR_2020]    AIA_MBR_2020   \n",
       "..   ...  ...             ...             ...             ...   \n",
       "149   UZ  UZB      Uzbekistan  [UZB_MBR_2020]    UZB_MBR_2020   \n",
       "150   VE  VEN       Venezuela  [VEN_MBR_2020]    VEN_MBR_2020   \n",
       "151   VN  VNM         Vietnam  [VNM_MBR_2020]    VNM_MBR_2020   \n",
       "152   VI  VIR  Virgin Islands  [VIR_MBR_2020]    VIR_MBR_2020   \n",
       "153   ZM  ZMB          Zambia  [ZMB_MBR_2019]    ZMB_MBR_2019   \n",
       "\n",
       "                              alt_name      continent  \n",
       "0                              ALBANIA         Europe  \n",
       "1                              ALGERIA         Africa  \n",
       "2                              ANDORRA         Europe  \n",
       "3                               ANGOLA         Africa  \n",
       "4                             ANGUILLA  North America  \n",
       "..                                 ...            ...  \n",
       "149                         UZBEKISTAN           Asia  \n",
       "150  VENEZUELA, BOLIVARIAN REPUBLIC OF  South America  \n",
       "151                           VIET NAM           Asia  \n",
       "152       UNITED STATES VIRGIN ISLANDS  North America  \n",
       "153                             ZAMBIA         Africa  \n",
       "\n",
       "[154 rows x 7 columns]"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_countries(gis)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Country - United States (GIS @ https://baqa.mapsqa.arcgis.com version:9.4)>"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cntry = Country('usa', gis=gis)\n",
    "\n",
    "cntry"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>alias</th>\n",
       "      <th>data_collection</th>\n",
       "      <th>enrich_name</th>\n",
       "      <th>enrich_field_name</th>\n",
       "      <th>description</th>\n",
       "      <th>vintage</th>\n",
       "      <th>units</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AGE0_CY</td>\n",
       "      <td>2021 Population Age &lt;1</td>\n",
       "      <td>1yearincrements</td>\n",
       "      <td>1yearincrements.AGE0_CY</td>\n",
       "      <td>F1yearincrements_AGE0_CY</td>\n",
       "      <td>2021 Total Population Age &lt;1 (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AGE1_CY</td>\n",
       "      <td>2021 Population Age 1</td>\n",
       "      <td>1yearincrements</td>\n",
       "      <td>1yearincrements.AGE1_CY</td>\n",
       "      <td>F1yearincrements_AGE1_CY</td>\n",
       "      <td>2021 Total Population Age 1 (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AGE2_CY</td>\n",
       "      <td>2021 Population Age 2</td>\n",
       "      <td>1yearincrements</td>\n",
       "      <td>1yearincrements.AGE2_CY</td>\n",
       "      <td>F1yearincrements_AGE2_CY</td>\n",
       "      <td>2021 Total Population Age 2 (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AGE3_CY</td>\n",
       "      <td>2021 Population Age 3</td>\n",
       "      <td>1yearincrements</td>\n",
       "      <td>1yearincrements.AGE3_CY</td>\n",
       "      <td>F1yearincrements_AGE3_CY</td>\n",
       "      <td>2021 Total Population Age 3 (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AGE4_CY</td>\n",
       "      <td>2021 Population Age 4</td>\n",
       "      <td>1yearincrements</td>\n",
       "      <td>1yearincrements.AGE4_CY</td>\n",
       "      <td>F1yearincrements_AGE4_CY</td>\n",
       "      <td>2021 Total Population Age 4 (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19148</th>\n",
       "      <td>MOEMEDYRMV</td>\n",
       "      <td>2019 Median Year Householder Moved In MOE (ACS...</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.MOEMEDYRMV</td>\n",
       "      <td>yearmovedin_MOEMEDYRMV</td>\n",
       "      <td>2019 Median Year Householder Moved into Unit M...</td>\n",
       "      <td>2015-2019</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19149</th>\n",
       "      <td>RELMEDYRMV</td>\n",
       "      <td>2019 Median Year Householder Moved In REL (ACS...</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.RELMEDYRMV</td>\n",
       "      <td>yearmovedin_RELMEDYRMV</td>\n",
       "      <td>2019 Median Year Householder Moved into Unit R...</td>\n",
       "      <td>2015-2019</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19150</th>\n",
       "      <td>ACSOWNER</td>\n",
       "      <td>2019 Owner Households (ACS 5-Yr)</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.ACSOWNER</td>\n",
       "      <td>yearmovedin_ACSOWNER</td>\n",
       "      <td>2019 Owner Households (ACS 5-Yr)</td>\n",
       "      <td>2015-2019</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19151</th>\n",
       "      <td>MOEOWNER</td>\n",
       "      <td>2019 Owner Households MOE (ACS 5-Yr)</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.MOEOWNER</td>\n",
       "      <td>yearmovedin_MOEOWNER</td>\n",
       "      <td>2019 Owner Households MOE (ACS 5-Yr)</td>\n",
       "      <td>2015-2019</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19152</th>\n",
       "      <td>RELOWNER</td>\n",
       "      <td>2019 Owner Households REL (ACS 5-Yr)</td>\n",
       "      <td>yearmovedin</td>\n",
       "      <td>yearmovedin.RELOWNER</td>\n",
       "      <td>yearmovedin_RELOWNER</td>\n",
       "      <td>2019 Owner Households REL (ACS 5-Yr)</td>\n",
       "      <td>2015-2019</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>19153 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             name                                              alias  \\\n",
       "0         AGE0_CY                             2021 Population Age <1   \n",
       "1         AGE1_CY                              2021 Population Age 1   \n",
       "2         AGE2_CY                              2021 Population Age 2   \n",
       "3         AGE3_CY                              2021 Population Age 3   \n",
       "4         AGE4_CY                              2021 Population Age 4   \n",
       "...           ...                                                ...   \n",
       "19148  MOEMEDYRMV  2019 Median Year Householder Moved In MOE (ACS...   \n",
       "19149  RELMEDYRMV  2019 Median Year Householder Moved In REL (ACS...   \n",
       "19150    ACSOWNER                   2019 Owner Households (ACS 5-Yr)   \n",
       "19151    MOEOWNER               2019 Owner Households MOE (ACS 5-Yr)   \n",
       "19152    RELOWNER               2019 Owner Households REL (ACS 5-Yr)   \n",
       "\n",
       "       data_collection              enrich_name         enrich_field_name  \\\n",
       "0      1yearincrements  1yearincrements.AGE0_CY  F1yearincrements_AGE0_CY   \n",
       "1      1yearincrements  1yearincrements.AGE1_CY  F1yearincrements_AGE1_CY   \n",
       "2      1yearincrements  1yearincrements.AGE2_CY  F1yearincrements_AGE2_CY   \n",
       "3      1yearincrements  1yearincrements.AGE3_CY  F1yearincrements_AGE3_CY   \n",
       "4      1yearincrements  1yearincrements.AGE4_CY  F1yearincrements_AGE4_CY   \n",
       "...                ...                      ...                       ...   \n",
       "19148      yearmovedin   yearmovedin.MOEMEDYRMV    yearmovedin_MOEMEDYRMV   \n",
       "19149      yearmovedin   yearmovedin.RELMEDYRMV    yearmovedin_RELMEDYRMV   \n",
       "19150      yearmovedin     yearmovedin.ACSOWNER      yearmovedin_ACSOWNER   \n",
       "19151      yearmovedin     yearmovedin.MOEOWNER      yearmovedin_MOEOWNER   \n",
       "19152      yearmovedin     yearmovedin.RELOWNER      yearmovedin_RELOWNER   \n",
       "\n",
       "                                             description    vintage  units  \n",
       "0                    2021 Total Population Age <1 (Esri)       2021  count  \n",
       "1                     2021 Total Population Age 1 (Esri)       2021  count  \n",
       "2                     2021 Total Population Age 2 (Esri)       2021  count  \n",
       "3                     2021 Total Population Age 3 (Esri)       2021  count  \n",
       "4                     2021 Total Population Age 4 (Esri)       2021  count  \n",
       "...                                                  ...        ...    ...  \n",
       "19148  2019 Median Year Householder Moved into Unit M...  2015-2019  count  \n",
       "19149  2019 Median Year Householder Moved into Unit R...  2015-2019  count  \n",
       "19150                   2019 Owner Households (ACS 5-Yr)  2015-2019  count  \n",
       "19151               2019 Owner Households MOE (ACS 5-Yr)  2015-2019  count  \n",
       "19152               2019 Owner Households REL (ACS 5-Yr)  2015-2019  count  \n",
       "\n",
       "[19153 rows x 8 columns]"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ev = cntry.enrich_variables\n",
    "\n",
    "ev"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>alias</th>\n",
       "      <th>data_collection</th>\n",
       "      <th>enrich_name</th>\n",
       "      <th>enrich_field_name</th>\n",
       "      <th>description</th>\n",
       "      <th>vintage</th>\n",
       "      <th>units</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>TOTPOP_CY</td>\n",
       "      <td>2021 Total Population</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.TOTPOP_CY</td>\n",
       "      <td>KeyUSFacts_TOTPOP_CY</td>\n",
       "      <td>2021 Total Population (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>GQPOP_CY</td>\n",
       "      <td>2021 Group Quarters Population</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.GQPOP_CY</td>\n",
       "      <td>KeyUSFacts_GQPOP_CY</td>\n",
       "      <td>2021 Group Quarters Population (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>DIVINDX_CY</td>\n",
       "      <td>2021 Diversity Index</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.DIVINDX_CY</td>\n",
       "      <td>KeyUSFacts_DIVINDX_CY</td>\n",
       "      <td>2021 Diversity Index (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>TOTHH_CY</td>\n",
       "      <td>2021 Total Households</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.TOTHH_CY</td>\n",
       "      <td>KeyUSFacts_TOTHH_CY</td>\n",
       "      <td>2021 Total Households (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AVGHHSZ_CY</td>\n",
       "      <td>2021 Average Household Size</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.AVGHHSZ_CY</td>\n",
       "      <td>KeyUSFacts_AVGHHSZ_CY</td>\n",
       "      <td>2021 Average Household Size (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>MEDHINC_CY</td>\n",
       "      <td>2021 Median Household Income</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.MEDHINC_CY</td>\n",
       "      <td>KeyUSFacts_MEDHINC_CY</td>\n",
       "      <td>2021 Median Household Income (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>currency</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>AVGHINC_CY</td>\n",
       "      <td>2021 Average Household Income</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.AVGHINC_CY</td>\n",
       "      <td>KeyUSFacts_AVGHINC_CY</td>\n",
       "      <td>2021 Average Household Income (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>currency</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>PCI_CY</td>\n",
       "      <td>2021 Per Capita Income</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.PCI_CY</td>\n",
       "      <td>KeyUSFacts_PCI_CY</td>\n",
       "      <td>2021 Per Capita Income (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>currency</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>TOTHU_CY</td>\n",
       "      <td>2021 Total Housing Units</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.TOTHU_CY</td>\n",
       "      <td>KeyUSFacts_TOTHU_CY</td>\n",
       "      <td>2021 Total Housing Units (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>OWNER_CY</td>\n",
       "      <td>2021 Owner Occupied HUs</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.OWNER_CY</td>\n",
       "      <td>KeyUSFacts_OWNER_CY</td>\n",
       "      <td>2021 Owner Occupied Housing Units (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>RENTER_CY</td>\n",
       "      <td>2021 Renter Occupied HUs</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.RENTER_CY</td>\n",
       "      <td>KeyUSFacts_RENTER_CY</td>\n",
       "      <td>2021 Renter Occupied Housing Units (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>VACANT_CY</td>\n",
       "      <td>2021 Vacant Housing Units</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.VACANT_CY</td>\n",
       "      <td>KeyUSFacts_VACANT_CY</td>\n",
       "      <td>2021 Vacant Housing Units (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>MEDVAL_CY</td>\n",
       "      <td>2021 Median Home Value</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.MEDVAL_CY</td>\n",
       "      <td>KeyUSFacts_MEDVAL_CY</td>\n",
       "      <td>2021 Median Home Value (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>currency</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>AVGVAL_CY</td>\n",
       "      <td>2021 Average Home Value</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.AVGVAL_CY</td>\n",
       "      <td>KeyUSFacts_AVGVAL_CY</td>\n",
       "      <td>2021 Average Home Value (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>currency</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>POPGRW10CY</td>\n",
       "      <td>2010-2021 Growth Rate: Population</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.POPGRW10CY</td>\n",
       "      <td>KeyUSFacts_POPGRW10CY</td>\n",
       "      <td>2010-2021 Population: Compound Annual Growth R...</td>\n",
       "      <td>2021</td>\n",
       "      <td>pct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>HHGRW10CY</td>\n",
       "      <td>2010-2021 Growth Rate: Households</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.HHGRW10CY</td>\n",
       "      <td>KeyUSFacts_HHGRW10CY</td>\n",
       "      <td>2010-2021 Households: Compound Annual Growth R...</td>\n",
       "      <td>2021</td>\n",
       "      <td>pct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>FAMGRW10CY</td>\n",
       "      <td>2010-2021 Growth Rate: Families</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.FAMGRW10CY</td>\n",
       "      <td>KeyUSFacts_FAMGRW10CY</td>\n",
       "      <td>2010-2021 Families: Compound Annual Growth Rat...</td>\n",
       "      <td>2021</td>\n",
       "      <td>pct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>POPGRWCYFY</td>\n",
       "      <td>2021-2026 Growth Rate: Population</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.POPGRWCYFY</td>\n",
       "      <td>KeyUSFacts_POPGRWCYFY</td>\n",
       "      <td>2021-2026 Population: Compound Annual Growth R...</td>\n",
       "      <td>2026</td>\n",
       "      <td>pct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>HHGRWCYFY</td>\n",
       "      <td>2021-2026 Growth Rate: Households</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.HHGRWCYFY</td>\n",
       "      <td>KeyUSFacts_HHGRWCYFY</td>\n",
       "      <td>2021-2026 Households: Compound Annual Growth R...</td>\n",
       "      <td>2026</td>\n",
       "      <td>pct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>FAMGRWCYFY</td>\n",
       "      <td>2021-2026 Growth Rate: Families</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.FAMGRWCYFY</td>\n",
       "      <td>KeyUSFacts_FAMGRWCYFY</td>\n",
       "      <td>2021-2026 Families: Compound Annual Growth Rat...</td>\n",
       "      <td>2026</td>\n",
       "      <td>pct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>MHIGRWCYFY</td>\n",
       "      <td>2021-2026 Growth Rate: Median HH Inc</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.MHIGRWCYFY</td>\n",
       "      <td>KeyUSFacts_MHIGRWCYFY</td>\n",
       "      <td>2021-2026 Median Household Income: Compound An...</td>\n",
       "      <td>2026</td>\n",
       "      <td>pct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>PCIGRWCYFY</td>\n",
       "      <td>2021-2026 Growth Rate: Per Capita Inc</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.PCIGRWCYFY</td>\n",
       "      <td>KeyUSFacts_PCIGRWCYFY</td>\n",
       "      <td>2021-2026 Per Capita Income: Compound Annual G...</td>\n",
       "      <td>2026</td>\n",
       "      <td>pct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>DPOP_CY</td>\n",
       "      <td>2021 Total Daytime Population</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.DPOP_CY</td>\n",
       "      <td>KeyUSFacts_DPOP_CY</td>\n",
       "      <td>2021 Total Daytime Population (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>DPOPWRK_CY</td>\n",
       "      <td>2021 Daytime Pop: Workers</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.DPOPWRK_CY</td>\n",
       "      <td>KeyUSFacts_DPOPWRK_CY</td>\n",
       "      <td>2021 Daytime Population: Workers (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>DPOPRES_CY</td>\n",
       "      <td>2021 Daytime Pop: Residents</td>\n",
       "      <td>KeyUSFacts</td>\n",
       "      <td>KeyUSFacts.DPOPRES_CY</td>\n",
       "      <td>KeyUSFacts_DPOPRES_CY</td>\n",
       "      <td>2021 Daytime Population: Residents (Esri)</td>\n",
       "      <td>2021</td>\n",
       "      <td>count</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          name                                  alias data_collection  \\\n",
       "0    TOTPOP_CY                  2021 Total Population      KeyUSFacts   \n",
       "1     GQPOP_CY         2021 Group Quarters Population      KeyUSFacts   \n",
       "2   DIVINDX_CY                   2021 Diversity Index      KeyUSFacts   \n",
       "3     TOTHH_CY                  2021 Total Households      KeyUSFacts   \n",
       "4   AVGHHSZ_CY            2021 Average Household Size      KeyUSFacts   \n",
       "5   MEDHINC_CY           2021 Median Household Income      KeyUSFacts   \n",
       "6   AVGHINC_CY          2021 Average Household Income      KeyUSFacts   \n",
       "7       PCI_CY                 2021 Per Capita Income      KeyUSFacts   \n",
       "8     TOTHU_CY               2021 Total Housing Units      KeyUSFacts   \n",
       "9     OWNER_CY                2021 Owner Occupied HUs      KeyUSFacts   \n",
       "10   RENTER_CY               2021 Renter Occupied HUs      KeyUSFacts   \n",
       "11   VACANT_CY              2021 Vacant Housing Units      KeyUSFacts   \n",
       "12   MEDVAL_CY                 2021 Median Home Value      KeyUSFacts   \n",
       "13   AVGVAL_CY                2021 Average Home Value      KeyUSFacts   \n",
       "14  POPGRW10CY      2010-2021 Growth Rate: Population      KeyUSFacts   \n",
       "15   HHGRW10CY      2010-2021 Growth Rate: Households      KeyUSFacts   \n",
       "16  FAMGRW10CY        2010-2021 Growth Rate: Families      KeyUSFacts   \n",
       "17  POPGRWCYFY      2021-2026 Growth Rate: Population      KeyUSFacts   \n",
       "18   HHGRWCYFY      2021-2026 Growth Rate: Households      KeyUSFacts   \n",
       "19  FAMGRWCYFY        2021-2026 Growth Rate: Families      KeyUSFacts   \n",
       "20  MHIGRWCYFY   2021-2026 Growth Rate: Median HH Inc      KeyUSFacts   \n",
       "21  PCIGRWCYFY  2021-2026 Growth Rate: Per Capita Inc      KeyUSFacts   \n",
       "22     DPOP_CY          2021 Total Daytime Population      KeyUSFacts   \n",
       "23  DPOPWRK_CY              2021 Daytime Pop: Workers      KeyUSFacts   \n",
       "24  DPOPRES_CY            2021 Daytime Pop: Residents      KeyUSFacts   \n",
       "\n",
       "              enrich_name      enrich_field_name  \\\n",
       "0    KeyUSFacts.TOTPOP_CY   KeyUSFacts_TOTPOP_CY   \n",
       "1     KeyUSFacts.GQPOP_CY    KeyUSFacts_GQPOP_CY   \n",
       "2   KeyUSFacts.DIVINDX_CY  KeyUSFacts_DIVINDX_CY   \n",
       "3     KeyUSFacts.TOTHH_CY    KeyUSFacts_TOTHH_CY   \n",
       "4   KeyUSFacts.AVGHHSZ_CY  KeyUSFacts_AVGHHSZ_CY   \n",
       "5   KeyUSFacts.MEDHINC_CY  KeyUSFacts_MEDHINC_CY   \n",
       "6   KeyUSFacts.AVGHINC_CY  KeyUSFacts_AVGHINC_CY   \n",
       "7       KeyUSFacts.PCI_CY      KeyUSFacts_PCI_CY   \n",
       "8     KeyUSFacts.TOTHU_CY    KeyUSFacts_TOTHU_CY   \n",
       "9     KeyUSFacts.OWNER_CY    KeyUSFacts_OWNER_CY   \n",
       "10   KeyUSFacts.RENTER_CY   KeyUSFacts_RENTER_CY   \n",
       "11   KeyUSFacts.VACANT_CY   KeyUSFacts_VACANT_CY   \n",
       "12   KeyUSFacts.MEDVAL_CY   KeyUSFacts_MEDVAL_CY   \n",
       "13   KeyUSFacts.AVGVAL_CY   KeyUSFacts_AVGVAL_CY   \n",
       "14  KeyUSFacts.POPGRW10CY  KeyUSFacts_POPGRW10CY   \n",
       "15   KeyUSFacts.HHGRW10CY   KeyUSFacts_HHGRW10CY   \n",
       "16  KeyUSFacts.FAMGRW10CY  KeyUSFacts_FAMGRW10CY   \n",
       "17  KeyUSFacts.POPGRWCYFY  KeyUSFacts_POPGRWCYFY   \n",
       "18   KeyUSFacts.HHGRWCYFY   KeyUSFacts_HHGRWCYFY   \n",
       "19  KeyUSFacts.FAMGRWCYFY  KeyUSFacts_FAMGRWCYFY   \n",
       "20  KeyUSFacts.MHIGRWCYFY  KeyUSFacts_MHIGRWCYFY   \n",
       "21  KeyUSFacts.PCIGRWCYFY  KeyUSFacts_PCIGRWCYFY   \n",
       "22     KeyUSFacts.DPOP_CY     KeyUSFacts_DPOP_CY   \n",
       "23  KeyUSFacts.DPOPWRK_CY  KeyUSFacts_DPOPWRK_CY   \n",
       "24  KeyUSFacts.DPOPRES_CY  KeyUSFacts_DPOPRES_CY   \n",
       "\n",
       "                                          description vintage     units  \n",
       "0                        2021 Total Population (Esri)    2021     count  \n",
       "1               2021 Group Quarters Population (Esri)    2021     count  \n",
       "2                         2021 Diversity Index (Esri)    2021     count  \n",
       "3                        2021 Total Households (Esri)    2021     count  \n",
       "4                  2021 Average Household Size (Esri)    2021     count  \n",
       "5                 2021 Median Household Income (Esri)    2021  currency  \n",
       "6                2021 Average Household Income (Esri)    2021  currency  \n",
       "7                       2021 Per Capita Income (Esri)    2021  currency  \n",
       "8                     2021 Total Housing Units (Esri)    2021     count  \n",
       "9            2021 Owner Occupied Housing Units (Esri)    2021     count  \n",
       "10          2021 Renter Occupied Housing Units (Esri)    2021     count  \n",
       "11                   2021 Vacant Housing Units (Esri)    2021     count  \n",
       "12                      2021 Median Home Value (Esri)    2021  currency  \n",
       "13                     2021 Average Home Value (Esri)    2021  currency  \n",
       "14  2010-2021 Population: Compound Annual Growth R...    2021       pct  \n",
       "15  2010-2021 Households: Compound Annual Growth R...    2021       pct  \n",
       "16  2010-2021 Families: Compound Annual Growth Rat...    2021       pct  \n",
       "17  2021-2026 Population: Compound Annual Growth R...    2026       pct  \n",
       "18  2021-2026 Households: Compound Annual Growth R...    2026       pct  \n",
       "19  2021-2026 Families: Compound Annual Growth Rat...    2026       pct  \n",
       "20  2021-2026 Median Household Income: Compound An...    2026       pct  \n",
       "21  2021-2026 Per Capita Income: Compound Annual G...    2026       pct  \n",
       "22               2021 Total Daytime Population (Esri)    2021     count  \n",
       "23            2021 Daytime Population: Workers (Esri)    2021     count  \n",
       "24          2021 Daytime Population: Residents (Esri)    2021     count  "
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kv = ev[\n",
    "    (ev.name.str.contains('CY'))\n",
    "    & (ev.data_collection.str.lower().str.contains('key'))\n",
    "].reset_index(drop=True)\n",
    "\n",
    "kv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>locnum</th>\n",
       "      <th>source_country</th>\n",
       "      <th>aggregation_method</th>\n",
       "      <th>population_to_polygon_size_rating</th>\n",
       "      <th>apportionment_confidence</th>\n",
       "      <th>has_data</th>\n",
       "      <th>totpop_cy</th>\n",
       "      <th>gqpop_cy</th>\n",
       "      <th>divindx_cy</th>\n",
       "      <th>tothh_cy</th>\n",
       "      <th>...</th>\n",
       "      <th>famgrw10_cy</th>\n",
       "      <th>popgrwcyfy</th>\n",
       "      <th>hhgrwcyfy</th>\n",
       "      <th>famgrwcyfy</th>\n",
       "      <th>mhigrwcyfy</th>\n",
       "      <th>pcigrwcyfy</th>\n",
       "      <th>dpop_cy</th>\n",
       "      <th>dpopwrk_cy</th>\n",
       "      <th>dpopres_cy</th>\n",
       "      <th>SHAPE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>105550909</td>\n",
       "      <td>US</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>2.191</td>\n",
       "      <td>2.576</td>\n",
       "      <td>1</td>\n",
       "      <td>5443</td>\n",
       "      <td>47</td>\n",
       "      <td>36.4</td>\n",
       "      <td>2391</td>\n",
       "      <td>...</td>\n",
       "      <td>0.30</td>\n",
       "      <td>1.71</td>\n",
       "      <td>1.72</td>\n",
       "      <td>1.48</td>\n",
       "      <td>2.39</td>\n",
       "      <td>2.09</td>\n",
       "      <td>8430</td>\n",
       "      <td>6007</td>\n",
       "      <td>2423</td>\n",
       "      <td>{\"rings\": [[[-122.70728508062291, 45.427343047...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>105633002</td>\n",
       "      <td>US</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>2.191</td>\n",
       "      <td>2.576</td>\n",
       "      <td>1</td>\n",
       "      <td>47</td>\n",
       "      <td>0</td>\n",
       "      <td>61.2</td>\n",
       "      <td>19</td>\n",
       "      <td>...</td>\n",
       "      <td>2.36</td>\n",
       "      <td>1.25</td>\n",
       "      <td>2.02</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.71</td>\n",
       "      <td>2.80</td>\n",
       "      <td>1197</td>\n",
       "      <td>1177</td>\n",
       "      <td>20</td>\n",
       "      <td>{\"rings\": [[[-122.92377807415231, 45.572420302...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>105759815</td>\n",
       "      <td>US</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>2.191</td>\n",
       "      <td>2.576</td>\n",
       "      <td>1</td>\n",
       "      <td>11170</td>\n",
       "      <td>1736</td>\n",
       "      <td>46.7</td>\n",
       "      <td>6869</td>\n",
       "      <td>...</td>\n",
       "      <td>1.43</td>\n",
       "      <td>3.13</td>\n",
       "      <td>3.51</td>\n",
       "      <td>3.44</td>\n",
       "      <td>5.39</td>\n",
       "      <td>3.21</td>\n",
       "      <td>29779</td>\n",
       "      <td>24597</td>\n",
       "      <td>5182</td>\n",
       "      <td>{\"rings\": [[[-122.6722509453407, 45.5353649659...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>177692910</td>\n",
       "      <td>US</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>2.191</td>\n",
       "      <td>2.576</td>\n",
       "      <td>1</td>\n",
       "      <td>6255</td>\n",
       "      <td>66</td>\n",
       "      <td>47.0</td>\n",
       "      <td>2636</td>\n",
       "      <td>...</td>\n",
       "      <td>0.20</td>\n",
       "      <td>0.61</td>\n",
       "      <td>0.58</td>\n",
       "      <td>0.46</td>\n",
       "      <td>1.45</td>\n",
       "      <td>2.41</td>\n",
       "      <td>5677</td>\n",
       "      <td>2756</td>\n",
       "      <td>2921</td>\n",
       "      <td>{\"rings\": [[[-122.6376659650056, 45.4365507371...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>180308389</td>\n",
       "      <td>US</td>\n",
       "      <td>BlockApportionment:US.BlockGroups;PointsLayer:...</td>\n",
       "      <td>2.191</td>\n",
       "      <td>2.576</td>\n",
       "      <td>1</td>\n",
       "      <td>13200</td>\n",
       "      <td>432</td>\n",
       "      <td>64.9</td>\n",
       "      <td>5109</td>\n",
       "      <td>...</td>\n",
       "      <td>0.34</td>\n",
       "      <td>0.58</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.51</td>\n",
       "      <td>3.03</td>\n",
       "      <td>2.69</td>\n",
       "      <td>12250</td>\n",
       "      <td>5193</td>\n",
       "      <td>7057</td>\n",
       "      <td>{\"rings\": [[[-122.53727969104438, 45.552657456...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 32 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      locnum source_country  \\\n",
       "0  105550909             US   \n",
       "1  105633002             US   \n",
       "2  105759815             US   \n",
       "3  177692910             US   \n",
       "4  180308389             US   \n",
       "\n",
       "                                  aggregation_method  \\\n",
       "0  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "1  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "2  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "3  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "4  BlockApportionment:US.BlockGroups;PointsLayer:...   \n",
       "\n",
       "   population_to_polygon_size_rating  apportionment_confidence  has_data  \\\n",
       "0                              2.191                     2.576         1   \n",
       "1                              2.191                     2.576         1   \n",
       "2                              2.191                     2.576         1   \n",
       "3                              2.191                     2.576         1   \n",
       "4                              2.191                     2.576         1   \n",
       "\n",
       "   totpop_cy  gqpop_cy  divindx_cy  tothh_cy  ...  famgrw10_cy  popgrwcyfy  \\\n",
       "0       5443        47        36.4      2391  ...         0.30        1.71   \n",
       "1         47         0        61.2        19  ...         2.36        1.25   \n",
       "2      11170      1736        46.7      6869  ...         1.43        3.13   \n",
       "3       6255        66        47.0      2636  ...         0.20        0.61   \n",
       "4      13200       432        64.9      5109  ...         0.34        0.58   \n",
       "\n",
       "   hhgrwcyfy  famgrwcyfy  mhigrwcyfy  pcigrwcyfy  dpop_cy  dpopwrk_cy  \\\n",
       "0       1.72        1.48        2.39        2.09     8430        6007   \n",
       "1       2.02        0.00        1.71        2.80     1197        1177   \n",
       "2       3.51        3.44        5.39        3.21    29779       24597   \n",
       "3       0.58        0.46        1.45        2.41     5677        2756   \n",
       "4       0.45        0.51        3.03        2.69    12250        5193   \n",
       "\n",
       "   dpopres_cy                                              SHAPE  \n",
       "0        2423  {\"rings\": [[[-122.70728508062291, 45.427343047...  \n",
       "1          20  {\"rings\": [[[-122.92377807415231, 45.572420302...  \n",
       "2        5182  {\"rings\": [[[-122.6722509453407, 45.5353649659...  \n",
       "3        2921  {\"rings\": [[[-122.6376659650056, 45.4365507371...  \n",
       "4        7057  {\"rings\": [[[-122.53727969104438, 45.552657456...  \n",
       "\n",
       "[5 rows x 32 columns]"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "e_df = cntry.enrich(in_df, enrich_variables=kv)\n",
    "\n",
    "e_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
